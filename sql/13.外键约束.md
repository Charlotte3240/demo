```sql
# 外键约束关联
-- 1. 存储引擎 使用 innodb
-- 2. 关联字段类型相同
-- 3. 外键要使用索引

# 创建表的时候创建外键
-- 创建一个主表
create table class (id int primary key not null auto_increment,name varchar(20) not null)
-- 创建子表，子表中含有外键
CREATE  table stu (
	id int primary key auto_increment,
	name varchar(30) not null,
	class_id int default null,
	# 定义外键
	constraint stu_class # 
	foreign key (class_id)
	references class(id)
	on DELETE cascade # 联级删除
) engine = InnoDB default charset=utf8mb4

# 在旧表中添加外键约束
alter table goods add
constraint goods_brand
foreign key (brandId)
references brand(id)
on DELETE cascade


# 删除外键约束
alter table goods drop foreign key goods_brand


# 联级操作
-- 此时删除brand表后，goods表中brandId为 brand表中tplink的id 的数据被删除
delete from brand WHERE brandName  = 'tplink'

# 设置外键约束 当删除时 设置为空
alter table goods add
constraint goods_brand
foreign key (brandId)
references brand(id)
on DELETE set NULL 

-- 此时删除brand表后，goods表中 brandId 设置为null
-- 即把外键设置成空，这里需要注意 外键一定要允许设置为null
delete from brand WHERE brandName  = 'tplink'


# 设置外键约束 当删除时 无操作, 但是必须先要把子表处理完，才可以删除主表
alter table goods  drop foreign key goods_brand

alter table goods  add
constraint goods_brand
foreign key (brandId)
references brand(id)
on DELETE restrict # no action 这两个是一个意思


-- 不能直接删除主表，要先把子表中对应的数据才能删除
delete from brand WHERE brandName = 'tplink'

-- 先删除子表
DELETE from goods WHERE brandId = (SELECT id from brand WHERE brandName  = 'tplink')
DELETE from brand WHERE brandName  = 'tplink'



# 关联更新
alter table  goods  drop foreign key goods_brand

alter table goods add 
constraint goods_brand
foreign key (brandId)
references brand(id)
on DELETE  no action
on UPDATE cascade

-- 更新了关联的id  用处不是特别大
update brand set id = 888 WHERE brandName = 'tplink'

alter table goods drop foreign key goods_brand

# 更新时设置为null
alter table goods add
constraint goods_brand
foreign key (brandId)
references brand(id)
on DELETE no action
on update set NULL 

update brand set id = 999 WHERE brandName = 'tplink'

# 更新时 无操作
ALTER TABLE goods drop foreign key goods_brand

alter table goods add
constraint goods_brand
foreign key (brandId)
references brand(id)
on DELETE set null
on update restrict # 8.0中no action 和 restrict 都代表限制

-- 不会直接更新成功，需要先更新子表
update brand set id = 233 WHERE brandName = 'tplink'

-- 更新子表, 注意，这里只能更新为null
update goods set brandId = NULL  WHERE id =  30


```

